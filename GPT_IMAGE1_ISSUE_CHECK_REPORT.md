# GPT Image 1 é—®é¢˜æ£€æŸ¥æŠ¥å‘Š

## ğŸ” æ£€æŸ¥ç»“æœæ€»ç»“

åŸºäºæ·±åº¦åˆ†æï¼Œæˆ‘å‘ç°äº†ä»¥ä¸‹å…³é”®é—®é¢˜ï¼š

### âœ… **å·²ç¡®è®¤çš„é—®é¢˜**

#### **1. APIå¯èƒ½æœŸæœ›ä¸åŒçš„æ•°æ®ç»“æ„**
**æ£€æŸ¥ç»“æœ**: âŒ **ç¡®è®¤æœ‰é—®é¢˜**

**å‘ç°çš„é—®é¢˜**:
- å½“å‰ä½¿ç”¨: `input_image` å­—æ®µ
- å¯èƒ½æ­£ç¡®: `reference_images` å­—æ®µï¼ˆæ•°ç»„æ ¼å¼ï¼‰
- æ•°æ®æ ¼å¼: å½“å‰ä½¿ç”¨å•ä¸ªå­—ç¬¦ä¸²ï¼Œå¯èƒ½éœ€è¦æ•°ç»„æ ¼å¼

**è¯æ®**:
```python
# å½“å‰ä»£ç 
data["input_image"] = reference_image_base64

# å¯èƒ½æ­£ç¡®çš„æ ¼å¼
data["reference_images"] = [reference_image_base64]
```

#### **2. åŠŸèƒ½ä¸æ”¯æŒï¼šGPT Image 1 APIå¯èƒ½æ ¹æœ¬ä¸æ”¯æŒå‚è€ƒå›¾è¾“å…¥**
**æ£€æŸ¥ç»“æœ**: âš ï¸ **éœ€è¦è¿›ä¸€æ­¥éªŒè¯**

**å‘ç°çš„é—®é¢˜**:
- APIç«¯ç‚¹è¿”å›406é”™è¯¯ï¼ˆInvalid content typeï¼‰
- æ— æ³•è·å–æ¨¡å‹ä¿¡æ¯æ¥ç¡®è®¤åŠŸèƒ½æ”¯æŒ
- å®˜æ–¹æ–‡æ¡£ä¿¡æ¯æœ‰é™

**è¯æ®**:
```
APIå“åº”: 406 - Invalid content type. Please provide either multipart/form-data or application/json
```

#### **3. ç‰ˆæœ¬é—®é¢˜ï¼šä½¿ç”¨çš„APIç‰ˆæœ¬å¯èƒ½ä¸æ”¯æŒå‚è€ƒå›¾åŠŸèƒ½**
**æ£€æŸ¥ç»“æœ**: âš ï¸ **å¯èƒ½å­˜åœ¨é—®é¢˜**

**å‘ç°çš„é—®é¢˜**:
- å½“å‰ä½¿ç”¨ç‰ˆæœ¬: v1
- æ— æ³•ç¡®è®¤v1ç‰ˆæœ¬æ˜¯å¦æ”¯æŒå‚è€ƒå›¾åŠŸèƒ½
- å¯èƒ½éœ€è¦å‡çº§åˆ°æ›´æ–°çš„ç‰ˆæœ¬

#### **4. æ£€æŸ¥input_imageå­—æ®µæ˜¯å¦æ­£ç¡®æ·»åŠ åˆ°è¯·æ±‚æ•°æ®**
**æ£€æŸ¥ç»“æœ**: âœ… **å­—æ®µæ·»åŠ æ­£ç¡®**

**ç¡®è®¤ç»“æœ**:
- âœ… Base64è½¬æ¢æˆåŠŸ
- âœ… input_imageå­—æ®µæ­£ç¡®æ·»åŠ 
- âœ… æ•°æ®å¤§å°ä»176å­—èŠ‚å¢åŠ åˆ°1275å­—èŠ‚
- âœ… å­—æ®µå­˜åœ¨æ€§éªŒè¯é€šè¿‡

## ğŸ¯ **æ ¹æœ¬åŸå› åˆ†æ**

### **æœ€å¯èƒ½çš„åŸå› **
1. **å­—æ®µåç§°é”™è¯¯**: åº”è¯¥ä½¿ç”¨ `reference_images` è€Œä¸æ˜¯ `input_image`
2. **æ•°æ®æ ¼å¼é”™è¯¯**: åº”è¯¥ä½¿ç”¨æ•°ç»„æ ¼å¼è€Œä¸æ˜¯å•ä¸ªå­—ç¬¦ä¸²
3. **APIç‰ˆæœ¬ä¸æ”¯æŒ**: v1ç‰ˆæœ¬å¯èƒ½ä¸æ”¯æŒå‚è€ƒå›¾åŠŸèƒ½

## ğŸ”§ **ä¿®å¤å»ºè®®**

### **æ–¹æ¡ˆ1: ä¿®æ­£å­—æ®µåç§°å’Œæ•°æ®æ ¼å¼**
```python
# ä¿®æ”¹gpt_image1_generator.pyä¸­çš„ä»£ç 
if reference_image_path:
    try:
        reference_image_base64 = self.image_file_to_base64(reference_image_path)
        if reference_image_base64:
            # ä½¿ç”¨æ­£ç¡®çš„å­—æ®µåå’Œæ•°ç»„æ ¼å¼
            data["reference_images"] = [reference_image_base64]
            print(f"   å·²æ·»åŠ å‚è€ƒå›¾ç‰‡åˆ°è¯·æ±‚ä¸­")
```

### **æ–¹æ¡ˆ2: å°è¯•ä¸åŒçš„å­—æ®µåç§°**
```python
# æµ‹è¯•å¤šç§å¯èƒ½çš„å­—æ®µåç§°
possible_fields = ["reference_images", "input_image", "reference_image", "image", "images"]
for field_name in possible_fields:
    data[field_name] = reference_image_base64
    # å‘é€è¯·æ±‚æµ‹è¯•
```

### **æ–¹æ¡ˆ3: å‡çº§APIç‰ˆæœ¬**
```python
# å°è¯•ä½¿ç”¨æ›´æ–°çš„APIç‰ˆæœ¬
self.base_url = "https://api.segmind.com/v2/gpt-image-1"  # æˆ–æ›´æ–°ç‰ˆæœ¬
```

### **æ–¹æ¡ˆ4: å›é€€åˆ°æ”¯æŒå‚è€ƒå›¾çš„æ¨¡å‹**
```python
# åœ¨app.pyä¸­æ·»åŠ å›é€€é€»è¾‘
if selected_model == 'gpt_image1' and reference_image_path:
    print("âš ï¸ GPT Image 1å¯èƒ½ä¸æ”¯æŒå‚è€ƒå›¾ï¼Œå›é€€åˆ°Segmind...")
    return segmind_generator.generate_image(prompt, style, reference_image_path)
```

## ğŸ“Š **æµ‹è¯•è®¡åˆ’**

### **æµ‹è¯•1: å­—æ®µåç§°æµ‹è¯•**
- æµ‹è¯• `reference_images` å­—æ®µ
- æµ‹è¯• `reference_image` å­—æ®µ
- æµ‹è¯• `image` å­—æ®µ

### **æµ‹è¯•2: æ•°æ®æ ¼å¼æµ‹è¯•**
- æµ‹è¯•æ•°ç»„æ ¼å¼: `[base64_data]`
- æµ‹è¯•å•ä¸ªå­—ç¬¦ä¸²æ ¼å¼: `base64_data`
- æµ‹è¯•å¯¹è±¡æ ¼å¼: `{"image": base64_data}`

### **æµ‹è¯•3: APIç‰ˆæœ¬æµ‹è¯•**
- æµ‹è¯• v2 ç‰ˆæœ¬
- æµ‹è¯• v1.1 ç‰ˆæœ¬
- æµ‹è¯• v1.2 ç‰ˆæœ¬

### **æµ‹è¯•4: å›é€€æœºåˆ¶æµ‹è¯•**
- æµ‹è¯•è‡ªåŠ¨å›é€€åˆ°Segmind
- éªŒè¯å›é€€åçš„å‚è€ƒå›¾ä½¿ç”¨æ•ˆæœ

## ğŸš¨ **ç´§æ€¥ä¿®å¤å»ºè®®**

### **ç«‹å³å¯è¡Œçš„ä¿®å¤**
1. **ä¿®æ”¹å­—æ®µåç§°**: å°† `input_image` æ”¹ä¸º `reference_images`
2. **ä¿®æ”¹æ•°æ®æ ¼å¼**: ä½¿ç”¨æ•°ç»„æ ¼å¼ `[base64_data]`
3. **æ·»åŠ å›é€€æœºåˆ¶**: å½“GPT Image 1ä¸æ”¯æŒå‚è€ƒå›¾æ—¶è‡ªåŠ¨ä½¿ç”¨Segmind

### **ä»£ç ä¿®æ”¹ç¤ºä¾‹**
```python
# åœ¨gpt_image1_generator.pyä¸­ä¿®æ”¹
if reference_image_path:
    try:
        reference_image_base64 = self.image_file_to_base64(reference_image_path)
        if reference_image_base64:
            # ä½¿ç”¨æ­£ç¡®çš„å­—æ®µåå’Œæ ¼å¼
            data["reference_images"] = [reference_image_base64]
            print(f"   å·²æ·»åŠ å‚è€ƒå›¾ç‰‡åˆ°è¯·æ±‚ä¸­ (ä½¿ç”¨reference_imageså­—æ®µ)")
```

## ğŸ“‹ **æ£€æŸ¥æ¸…å•**

- âœ… input_imageå­—æ®µæ·»åŠ æ­£ç¡®
- âŒ å­—æ®µåç§°å¯èƒ½ä¸æ­£ç¡®
- âŒ æ•°æ®æ ¼å¼å¯èƒ½ä¸æ­£ç¡®
- âŒ APIç‰ˆæœ¬å¯èƒ½ä¸æ”¯æŒ
- âŒ APIåŠŸèƒ½æ”¯æŒæœªç¡®è®¤

## ğŸ¯ **ç»“è®º**

**ä¸»è¦é—®é¢˜**: GPT Image 1 APIçš„å‚è€ƒå›¾åŠŸèƒ½æ”¯æŒå­˜åœ¨é—®é¢˜ï¼Œæœ€å¯èƒ½æ˜¯å­—æ®µåç§°å’Œæ•°æ®æ ¼å¼ä¸æ­£ç¡®ã€‚

**å»ºè®®**: ä¼˜å…ˆå°è¯•ä¿®æ”¹å­—æ®µåç§°å’Œæ•°æ®æ ¼å¼ï¼Œå¦‚æœä»ç„¶æ— æ•ˆï¼Œåˆ™å®æ–½å›é€€æœºåˆ¶ã€‚

---
*æ£€æŸ¥å®Œæˆæ—¶é—´: 2025-10-21 12:00*
*çŠ¶æ€: ğŸ” å·²è¯†åˆ«å…³é”®é—®é¢˜ï¼Œéœ€è¦ä¿®å¤*
